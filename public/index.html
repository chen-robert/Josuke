<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>
  <style>
    .subclass{
      font-size: 12px;
      margin: 0;
    }
  </style>
  <script>
    $.get("/data", data => {
      const el = document.createElement("div");
      el.innerHTML = data;

      window.el = el;

      const children = Array.from(el.children);
      const tags = [];

      let curr = {innerText: "", children: []};
      for(let i = 0; i < children.length; i++){
        const a = children[i];
        if(a.tagName !== "P"){
          tags.push(curr);
          curr = {innerText: a.innerText, children: []};
        }else{
          curr.children.push(a);
        }
      }
      tags.push(curr);
      
      const clean = text => text.split("T.").join("<br>T.");
      
      const subText = a => {
        let text = a.innerText;
        text = text.replace(/((www\.|https?:\/\/)[^\s]+)/g, "<a href='$1'>$1</a>");
        console.log(text);
        
        return `<p class="subtext">${text}</p>`;
        
      }
      const build = name => {
        document.body.insertAdjacentHTML(
          "beforeend",
`
<h3>${name}</h3>
${tags
  .filter(a => a.innerText.toLowerCase().includes(name.toLowerCase()))
  .map(a => `<strong>${clean(a.innerText)}</strong>${a.children.map(subText).join("")}`).join("")}
`
        );
      };
      build("Yemen");
      build("Oil");

      window.build = build;
    });


  </script>
</body>
